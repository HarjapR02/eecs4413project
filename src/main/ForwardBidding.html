<!DOCTYPE html>
<html>
<head>
    <title>Bidding Page</title>
</head>
<body>
    <!-- Company Logo -->
    <div>
        <img src="/images/logo.png" alt="Company Logo" />
    </div>

    <!-- Item Details -->
    <h2>Item Description</h2>
    <p id="description">Loading...</p>
    <p>Shipping Price: $<span id="shippingPrice"></span></p>
    <p>Current Price: $<span id="currentPrice"></span></p>
    <p>Highest Bidder: <span id="highestBidder"></span></p>

    <!-- Bid Form -->
    <form id="bidForm">
        <label for="bidPrice">Your Bid:</label>
        <input type="number" id="bidPrice" name="bidPrice" required />
        <button type="button" onclick="placeBid()">BID</button>
    </form>

    <p id="bidMessage"></p>

    <script>
        const itemId = new URLSearchParams(window.location.search).get('itemId');

        // Load item details
        async function loadItemDetails() {
            const response = await fetch(`/auction/item/${itemId}`);
            const item = await response.json();

            document.getElementById('description').textContent = item.description;
            document.getElementById('shippingPrice').textContent = item.shippingPrice;
            document.getElementById('currentPrice').textContent = item.currentPrice;
            document.getElementById('highestBidder').textContent = item.highestBidder;
        }

        // Place bid
        async function placeBid() {
            const bidPrice = document.getElementById('bidPrice').value;

            const response = await fetch(`/auction/item/${itemId}/bid`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ bidPrice, bidderId: "user123" }) // Example bidderId
            });

            const message = await response.text();
            document.getElementById('bidMessage').textContent = message;

            if (response.ok) {
                loadItemDetails(); // Refresh current price and highest bidder
            }
        }

        window.onload = loadItemDetails;
    </script>
</body>
</html>
